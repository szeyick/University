## Lab 2

### Quick Notes

- Results can be ordered again and again by appending ORDER BY <column name> ASC, <column name 2> DESC etc.

- The wildcard % means '0 or more characters', where '%HELLO%' means 0 or more characters before and after HELLO. This needs to be in the format of WHERE <column name> LIKE '%HELLO%', where LIKE is the wildcard that goes with it.

- The <> symbol appears to mean, 'everything that is not' or !=.
 
- The type **char** can be used, however the parser will fill in the gaps to fill up the defined number of characters.
 
### Theory Questions

- **Describe the difference between a database and DBMS**

A database is the data structure or container in which the data/information is kept in. A database is a orderly structure in which the data is organised.

A DBMS or database management system, is the means in which allows us to create a database and manipulate its contents with series of SQL statements.

- **Convert the ERD to a Relational Schema**

![alt text](https://github.com/szeyick/University/blob/master/INF60009%20-%20Database%20Analysis%20and%20Design/Lab%20Solutions/Lab%202%20-%20Database%20Basic/images/Movie.png "Movie")

A relational schema is the middlepoint of converting a ERD to a Relational Model. It is the means in which we define the statement that will allow us to structure the relational models columns and table.

In the ERD, we have 4 components, 3 are attributes and an entity. They are as follows -

**Attributes** - MovieId, Title, Release Year.
**Entity** - Movie

Furthermore, the primary key is identified with an underline, which in the ERD is defined as the MovieId attribute.

A relational schema is in the form of EntityName (PrimaryKey, Attribute 1, Attribute 2, ...)

Therefore for the relational schema of the ERD we will have - **Movie (MovieId, Title, ReleaseYear)**.

- **Write the CREATE TABLE statement for a table based on the relational schema created in the previous question**

The SQL statement to create a table with column (attribute) names will follow the template of -

**CREATE TABLE \<tableName\> (
	\<attributeName\> \<type\>,
	\<attributeName\> \<type\>,
	\<attributeName\> \<type\>,
	\<foreignKey\> \<attributeName\>
);**

If we plug in our relational schema into the statement template we will have - 

**CREATE TABLE Movie (
	MovieId NUMBER(6) NOT NULL,
	Title VARCHAR2(100),
	ReleaseYear NUMBER(4),
	Primary Key (MovieId)
);**

**It should be noted that VARCHAR2 is used over VARCHAR as it allows for empty string to be defined as NULL.**
**The type number(n,m) will mean n numbers and m decimals**

- **For each of the following statements, indicate if the statement is valid or invalid**

Table name - WORKER

| WorkderId | Name    | Age  | Gender  |
| :-------: |:-------:| :---:|:------: |
| 265       | Sanjay  | 18   | M       |
| 317       | Ky      | 25   |F        |
| 41        | Dave    | 36   |M        |
| 512       | Brenda  | 17   |F        |
| 9         | Helen   | 25   |F        |

**SELECT WorkderId, Age** 

Invalid as there is no definition of which table to select from.

**SELECT \* FROM Worker** 

Valid as there it is not case sensitive.

**SELECT Dave FROM Worker** 

Invalid as Dave is not a column name

**SELECT ALL FROM Worker** 

Invalid as ALL is not a column name

**SELECT Name FROM Worker WHERE Gender Is M** 

Invalid as "Is" is not valid SQL syntax and M should be 'M'

**SELECT Name, Age ORDER BY Age DESC** 

Invalid as there is no table selected.

**SELECT * FROM WORKER ORDER BY Name** 

Valid.

**List the output generated by these statements?**

**SELECT name FROM Worker;** 

Displays only the names of the entries in the table Worker.

**SELECT name, age FROM Worker;** 

Displays the names and the age columns from all entries in Worker.

**SELECT workerid, gender, age FROM Worker;** 

Displays workderid, gender, age columns and entries in Worker.

**SELECT * FROM Worker;** 

Displays all columns and data from table worker.

**SELECT name, age FROM Worker WHERE Age = 25;** 

Displays Ky and Helen details (name and age columns).

**SELECT name FROM Worker WHERE Age <> 18;** 

It will return everyone by Sanjay (name column).

**SELECT name FROM Worker WHERE Age != 25;** 

Displays everyone but Ky and Helen (name column)

**SELECT name FROM Worker WHERE Age <= 18;** 

Displays Sanjay and Brenda (name column).

**SELECT name FROM Worker WHERE Gender = 'M';** 

Displays all males

**SELECT name FROM Worker WHERE Gender <> 'M';** 

It will return all the females (name column).

**SELECT * FROM Worker WHERE Name = 'Bruce';** 

Displays nothing.

**SELECT * FROM Worker WHERE Name = 'Dave';** 

Displays all of Daves entered details (all columns).

**SELECT * FROM Worker WHERE Name = 'DAVE';** 

Displays nothing as values are case sensitive so DAVE != Dave

**SELECT name FROM Worker WHERE gender = 'f';** 

Displays nothing as values are case sensitive.

**SELECT name FROM Worker WHERE gender <> 'f';** 

Returns everyone so long as their gender != f

The <> symbol appears to mean, 'everything that is not'.

- **Consider the ERD**

![alt text](https://github.com/szeyick/University/blob/master/INF60009%20-%20Database%20Analysis%20and%20Design/Lab%20Solutions/Lab%202%20-%20Database%20Basic/images/TaskEmployee.png "Movie")

**Specify the relationship between Task and Employee by reading Left to Right.**

One Task is assigned to One Employee.

**Specify the relationship between Task and Employee by reading Right to Left.**

One Employee can be assigned to Many Tasks.

**When converted to a relational schema, will any of the relations have a foreign key? Why?**

The Task entity will have the foreign key, as the general rule is that the Entity containing the "many" relationship will inherit the additional column. The reason for this is for us to be able to identify which Employee entity has the relationship with the particular Task entity.

**Convert the ERD to a Relational Schema**

A relational schema is in the form of EntityName (PrimaryKey, Attribute 1, Attribute 2, ..., Foreign Key)

This will result in our 2 relational schemas for the Task and Employee entity to look like this -

**Task(TaskId, TaskName, EmpId)**
**Employee(EmpId, EmpName, Gender)**

**Read the relationships Left to Right and Right to Left specified by the following ERD**

![alt text](https://github.com/szeyick/University/blob/master/INF60009%20-%20Database%20Analysis%20and%20Design/Lab%20Solutions/Lab%202%20-%20Database%20Basic/images/StaffDept.png "Movie")

**One STAFF is assigned to One DEPT**
**One DEPT can be assigned to Many STAFF**

**When converted to a relational scehema, which relation will have a Foreign Key?**

The entity that has the "many" relationship will inherit the Foreign Key, in this case it will be the STAFF entity.

**Below are two tables based on the above ERD**

Table name - STAFF

| StaffNo    | StaffName     | OfficeNo  | DeptID  |
| :--------: | :-----------: |:---------:|:------: |
| 0001       | Eric Ng       | 301       | ACC     |
| 0066       | Dave Smith    | 110       | SL      |
| 0015       | Ron Nguyen    | 224       | SI      |
| 0038       | Tina Tran     | 110       | SL      |
| 0004       | Kim Lim       | 303       | ACC     |
| 0045       | Sally Odd     | 110       |         |
| 0027       | Brenda Lee    | 103       | HD      |
| 0045       | David Gold    | 111       | SL      |

Table name - DEPT

| DeptID    | DeptName       | ManagerName    |
| :-------: |:--------------:| :------------: |
| ACC       | Accounts       | Ted Baxter     | 
| SL        | Sales Local    | Mary Richards  |
| SI        | Sales National | Sue Ann Nivens |
| HD        | Help Desk      | Lou Grant      |

**What is the Primary Key of the Staff Table?** 

StaffNo

**What is the Primary Key of the Dept Table?** 

DeptID

**Which table has the foreign key?** 

Staff Table contains the foreign key.

**Who is the manager of the department that Ron works for?** 

Sue Ann Nivens.

**What is the name of Brenda's Department?** 

Help Desk

**Can the following row be added to the STAFF Table? If not, why not?**

| 0077    | Eric Ng     | 502  | ACC  |

Yes it can be added, even though the name already exists, it is not the primary key therefore the rest of the items can be duplicated.

**Can the following row be added to the STAFF Table? If not, why not?**

| 0015    | Karen White     | 110  | HD  |

No it cannot because the StaffNo 0015 already belongs to Ron Ngyuen. StaffNo is the Primary Key in the table that cannot take duplicate values, therefore this entry will be rejected.

**Can the following row be added to the STAFF Table? If not, why not?**

| 0012    | Jim Bender     | 303  |   |

Yes it can be, unless the foreign key has been specifically stated for NOT NULL, NULL entries can be added. It just means that the staff member Jim Bender is not assigned to a department.

- **Consider the following SQL statement:**

CREATE TABLE Person (
	PerId NUMBER PRIMARY KEY,
	PerName VARCHAR(50)
);

**How many tables would be created if you were to execute this statement in iSQL Jr?** 

1 table will be created with the columns as PerId and PerName. The PerId will be set as the Primary Key for the table.

**What occurs if you were to execute this statement a second or third time?**

It will state that the table is already there and will not create additional ones.

**Consider this script of SQL statements:**

DROP TABLE Worker;
CREATE TABLE Worker (
	WID NUMBER PRIMARY KEY,
	WName VARCHAR(50)
);

**What is the significance of the ; symbol in this script?**

The ; defines the end of a statement, meaning that the parser that reads the commands will know that it is the end of the first statement.

**What happens whenver the first statement of the script is executed?**

The table Table is deleted if it has been created previously.

**What occurs if you were to execute this script a second or third time?**

The table will be repetitively deleted, created each time you run the script. The first time will generate an error if there is no table by that name, however subsequent calls to the same steps will delete and re-create the table.

### Lab Questions

## SQL Statements

**Write the SQL statement to list only the TITLE and RELYEAR columns of every row**

SELECT TITLE, RELYEAR FROM MOVIE;

**List the RELYEAR and TITLE columns from all rows in ASCENDING RELYEAR sequence**

SELECT RELYEAR, TITLE FROM MOVIE ORDER BY RELYEAR ASC;

**List the MOVIE NO, TITLE, IMDB_SCORE and RELYEAR of every row in DESCENDING IMDB_SCORE sequence**

SELECT MOVIENO, TITLE, IMDB_SCORE, RELYEAR FROM MOVIE ORDER BY IMDB_SCORE DESC;

**List the TITLE and RATING_CODE of all movies that have a PG RATING_CODE**

SELECT TITLE, RATING_CODE FROM MOVIE WHERE RATING_CODE = 'PG';

**List the TITLE and RELYEAR of all movies made after 1999.**

SELECT TITLE, RELYEAR FROM MOVIE WHERE RELYEAR > 1999;

**List the TITLE and RELYEAR of all movies made after 1999, in ASCENDING RELYEAR SEQUENCE.**

SELECT TITLE, RELYEAR FROM MOVIE WHERE RELYEAR > 1999 ORDER BY RELYEAR ASC;

**List the TITLE and RELYEAR of all movies made after 1999, in ASCENDING RELYEAR SEQUENCE and within RELYEAR, movies must be ORDER by ASCENDING TITLE.**

SELECT TITLE, RELYEAR FROM MOVIE WHERE RELYEAR > 1999 ORDER BY RELYEAR ASC, TITLE ASC;

**List the TITLE, RELYEAR and IMDB_SCORE of all movies that are title Hamlet**

SELECT TITLE, RELYEAR, IMDB_SCORE FROM MOVIE WHERE TITLE LIKE '%Hamlet%';

**List the TITLE, RELYEAR and IMDB_SCORE of all movies that are titled HAMLET**

SELECT TITLE, RELYEAR, IMDB_SCORE FROM MOVIE WHERE TITLE LIKE '%HAMLET%';

**List the TITLE and RUNTIME of all movies that are shorter than 100 minutes in ASCENDING TITLE SEQUENCE**

SELECT TITLE, RUNTIME FROM MOVIE WHERE RUNTIME < 100 ORDER BY TITLE ASC;

**List all details of movies that hvae an IMDB_SCORE of 5.0 or below in ASCENDING RELYEAR SEQUENCE**

SELECT * FROM MOVIE WHERE IMDB_SCORE <= 5.0 ORDER BY RELYEAR ASC;

## Creating Scripts

**Create a table that represents the ER Diagram**

![alt text](https://github.com/szeyick/University/blob/master/INF60009%20-%20Database%20Analysis%20and%20Design/Lab%20Solutions/Lab%202%20-%20Database%20Basic/images/Car.png "Movie")

DROP TABLE CAR;
CREATE TABLE CAR (
	CarId VARCHAR(20) PRIMARY KEY,
	Model VARCHAR(20),
	Kms NUMBER(6)
);

**Add Insert statements that add the following data into the table:**

WSX040 Holden Magnum 23400
ABC123 Mazda 951 39500
PUG693 Toyota Blitz 14704

INSERT INTO CAR (CarId, Model, Kms) VALUES ('WSX040', 'Holden Magnum', 23400);
INSERT INTO CAR (CarId, Model, Kms) VALUES ('ABC123', 'Mazda 951', 39500);
INSERT INTO CAR (CarId, Model, Kms) VALUES ('PUG693', 'Toyota Blitz', 14704);

**Add a select statement to list all the rows in the Car table in ascending CarId sequence**

SELECT * FROM CAR ORDER BY CarId ASC;

**Add a select statement to list only CarId and Kms from all the rows in the Car table that have less than 30000 kms. The list must be descending kms sequence.**

SELECT CarId, Kms FROM CAR WHERE Kms < 30000 ORDER BY Kms DESC;
