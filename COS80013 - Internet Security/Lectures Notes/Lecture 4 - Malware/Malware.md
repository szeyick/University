## Lecture 4 Notes

This lecture contains notes about different types of malware.

### Virus

One of the original forms of malware written by hackers for fun. It is capable to destroying data, crashing programs and generally annoying users, however is not that big of a deal anymore since other types of malware is more of an issue than viruses.

Viruses are generally detected by verifying part of the viruses signature in a suspect file against a known black list of viruses. This generally isn't the best way to defend against viruses as it requires prior knowledge of it so would be useless against zero day attacks. 

Not all viruses were used to destroy data since the **Brain** and **Stoned** viruses of the mid 80's simply displayed a message indicating that the virus was there.

### Virus History

In the 80's viruses were generally transferred by floppy disks that contained shareware or pirated software. It was written onto the disk so when the software was installed it would also unpack the virus files. 

In the 90's viruses found themselves inside macros of Microsoft Office files and were quite effective since they were automatically executed as soon as the document was loaded. This feature was later disabled by Microsoft as a means to prevent the spread of macro based viruses.

In the 2000's, viruses would alter themselves to try and avoid detection from anti-virus software, since the virus was compared with a known database of other viruses it would change itself to attempt to hide.

These days, viruses generally find themselves as part of executable scripts inside website code.

### Worms

Worms are a type of malware that spreads through a program that has networking capabilities. The difference between a worm and a virus is that a worm does not need human intervention to spread as it seeks out networks to hijack.

Mallicious websites sometimes contain code within their pages to execute hidden links that cannot be seen unless the source code is inspected.

### Conficker Worm

This worm discovered in 1998 was a multithreaded worm that disables anti-virus, windows updates and even wireshark to attempt to close all the programs capable of detecting it. It also override the local host files on the infected computer to restrict access to anti-virus websites to download updates.

It used uPnP (Unified Plug and Play) to white list a port and open it for outside access. It did do something good in that it blocked other types of worms from infecting.

It updated itself over port 80 which is the port that browsers use so anti-virus and firewall programs would deem that it was safe traffic and let it through.

### Trojans

A trojan is a type of malware that acts as a container that distributes malware hidden inside itself using the unused bytes at the end of a file. Usually it is written to be a copy of some type of legitimate software.

Trojans are usually found with pirated or shareware. The hidden payload would probably contain a network client or server allowing external connections even if the program was closed. Once this was established, the hacker would install other types of software to monitor key logs, screen captures and other things.

On home computers, trojans are generally the most common as people would usually use administrator or root access to install the infected software. This would give free passage to the software to override settings that would usually require higher access levels to do so.

### Trojan Lifecycle

- **Make Bait** - Advertise free software, something really attractive like Photoshop.
- **Make Payload** - Create the mallicious software bundle that will install when the user installs the downloaded file.
- **Make Container** - Add the payload to the software distribution.
- **Make Dropper** - Make the executable that will install both the legitimate software and mallicious payload.
- **Add All to Container** - Add everything together to make a software container.
- **When container executed** - Unpack everything and install.

### Root Kit

A root kit is a technology that is used by malware. It generally patches the OS kernel so task manager and explorer cannot find them, so it doesn't show up on process or task lists.

Because root kits patch the software that usually details everything that is running on a computer, it allows for easier delivery of other types of malware as you cannot see what has been installed or running.

Because the files are essentially hidden from the operating system, it would require booting into another operating system or safe mode to remove the infected files.

### Adware

Is software that downloads ads into the web browser. It usually installs itself and opens up a TCP or UDP socket to send information about the infected computer to somewhere else. 

Adware programs can be detected by monitoring outgoing TCP connections using tools like Netstat.

Whilst not directly harming the host computer, adware can be used as key loggers, sending cookies and other information to hackers or corporations. Not all adware is used to send from the host as it can also be used to download ads to the users computer or even redirect their browsers to another website.

### Spyware

There is a really thin line between what is considered as adware and what is spyware. Some large corporations such as Microsoft even use spyware to monitor their media player that may play illegally downloaded music.

LinkedIn is another organisation that has been occused of downloading user data to use for their own purposes.

Spyware is hard to remove as it usually manifests itself as scripts in the form of .ini and .dll files and also link themselves to the registry. Removing one entry will only have one of the other links recreate themselves. It can also use root kits to evade detection by hiding their running processes and connections.

### Browser Hijacking

A form of spyware that affects the browser. It can be used to enable ports, add websites and redirect a user to another website. Adware toolbars can also be installed along with other forms of software. Sometimes can be hard to remove as it attaches itself to running processes so it cannot be removed whilst some critical process is still running.

Browsers are incredibly succeptible to this since anti-virus and firewall programs will allow traffic through the browser port (80) so it will be constantly running and executing scripts.

### Bots and Botnet

Is a type of malware that allows an AI to take control of the infected computer. Essentially can be used for anything that the hacker or customer wants.

A RAT (Remote Access Trojan) allows for a hacker to see exactly what the user sees as a form of remote desktop connection. This is different to the normal Bot that manifests itself as an command line based IRC client. This would be the equivelant of having an active terminal session that allows you to access the infected host.

### Non Application Malware

Malware does not need to be in a form of an executable. There has been instances of malware being installed in images and documents that can inject the malware into the read stream of the program that opens the file.

### Detection and Removal

Purely using anti-virus programs is not the best way to protect yourself from malware. Keeping the anti virus up to date and using multi level protection, including firewalls would be a better way to protect a computer.

In addition, never use root or adminstrator accounts to access the internet as it provides direct access to top most user priveledges in the system. 

Using a VM or another type of sandboxed environment would be good to test possible mallicious software since it would only infect the VM, deleting the VM or restarting it would not result in infecting the underlying OS.

To remove malware, if there is a root kit used, would require booting into safe mode or even re-installing the OS again.



